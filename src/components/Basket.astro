<button
  x-data="Basket"
  @update-bookmarks.window="incommingUpdate"
  @click="showBookmarks = !showBookmarks"
  class="flex flex-row-reverse gap-4 items-center">
  <h3
    class="px-4 bg-black text-white pt-1.5 pb-2 rounded-md"
    x-html="getBookmarks">
  </h3>
  <div
    class="flex gap-2"
    x-show="showBookmarks">
    <template x-for="item in bookmarkList">
      <h1
        x-text="item"
        class="border-2 border-black pt-1.5 pb-2 px-4 text-xs rounded-md font-semibold">
      </h1>
    </template>
  </div>
</button>

<script is:inline>
  function Basket() {
    return {
      init() {},
      isVisible: false,
      currentBookmarks: 0,
      showBookmarks: true,
      bookmarkList: [],
      incommingUpdate() {
        const state = this.$event.detail.state
        const target = this.$event.detail.info.parentNode.id

        if (state) {
          if (!this.bookmarkList.includes(target)) {
            this.bookmarkList.push(target)
            this.currentBookmarks += 1
          }
        } else {
          const index = this.bookmarkList.indexOf(target)
          if (index !== -1) {
            this.bookmarkList.splice(index, 1)
            this.currentBookmarks -= 1
          }
        }
      },
      getBookmarks() {
        return `<span class="font-bold">${this.currentBookmarks}</span> BookMarks`
      },
    }
  }
</script>
